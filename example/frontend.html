<html>

<head>
    <title>Example</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h2>RedSys POS example</h2>
            </div>
            <div class="col-12">
                <hr>
                <h4>Sandbox</h4>

                <form name="from" action="https://sis-t.redsys.es:25443/sis/realizarPago" method="POST">

                    <div class="form-group">
                        <label for="Ds_SignatureVersion">Ds_SignatureVersion</label>
                        <input type="text" readonly name="Ds_SignatureVersion" value="HMAC_SHA256_V1" class="form-control" />
                    </div>

                    <div class="form-group">
                        <label for="Ds_MerchantParameters">Ds_MerchantParameters</label>
                        <input type="text" name="Ds_MerchantParameters" class="form-control" value="eyJEU19NRVJDSEFOVF9BTU9VTlQiOiIxNDUiLCJEU19NRVJDSEFOVF9PUkRFUiI6IjE1MDg0MjgzNjAiLCJEU19NRVJDSEFOVF9NRVJDSEFOVENPREUiOiIzMjcyMzQ2ODgiLCJEU19NRVJDSEFOVF9DVVJSRU5DWSI6Ijk3OCIsIkRTX01FUkNIQU5UX1RSQU5TQUNUSU9OVFlQRSI6IjAiLCJEU19NRVJDSEFOVF9URVJNSU5BTCI6IjEiLCJEU19NRVJDSEFOVF9NRVJDSEFOVFVSTCI6IiIsIkRTX01FUkNIQU5UX1VSTE9LIjoiIiwiRFNfTUVSQ0hBTlRfVVJMS08iOiIifQ=="
                        />
                    </div>

                    <div class="form-group">
                        <label for="Ds_Signature">Ds_Signature</label>
                        <input type="text" name="Ds_Signature" class="form-control" value="2wzHhG3STJg6m3DTlvf74JHBXp5MI7Ey+scuClRcEzg=" />
                    </div>

                    <input type="submit" value="Submit form" class="btn btn-primary" />
                </form>
            </div>
            <div class="col-12">
                <hr>
                <h4>Production</h4>

                <form name="from" action="https://sis.redsys.es/sis/realizarPago" method="POST">

                    <div class="form-group">
                        <label for="Ds_SignatureVersion">Ds_SignatureVersion</label>
                        <input type="text" readonly name="Ds_SignatureVersion" value="HMAC_SHA256_V1" class="form-control" />
                    </div>

                    <div class="form-group">
                        <label for="Ds_MerchantParameters">Ds_MerchantParameters</label>
                        <input type="text" name="Ds_MerchantParameters" class="form-control" value="eyJEU19NRVJDSEFOVF9BTU9VTlQiOiIxNDUiLCJEU19NRVJDSEFOVF9PUkRFUiI6IjE1MDg0MjgzNjAiLCJEU19NRVJDSEFOVF9NRVJDSEFOVENPREUiOiIzMjcyMzQ2ODgiLCJEU19NRVJDSEFOVF9DVVJSRU5DWSI6Ijk3OCIsIkRTX01FUkNIQU5UX1RSQU5TQUNUSU9OVFlQRSI6IjAiLCJEU19NRVJDSEFOVF9URVJNSU5BTCI6IjEiLCJEU19NRVJDSEFOVF9NRVJDSEFOVFVSTCI6IiIsIkRTX01FUkNIQU5UX1VSTE9LIjoiIiwiRFNfTUVSQ0hBTlRfVVJMS08iOiIifQ=="
                        />
                    </div>

                    <div class="form-group">
                        <label for="Ds_Signature">Ds_Signature</label>
                        <input type="text" name="Ds_Signature" class="form-control" value="2wzHhG3STJg6m3DTlvf74JHBXp5MI7Ey+scuClRcEzg=" />
                    </div>

                    <input type="submit" value="Submit form" class="btn btn-success" />
                </form>
            </div>
            <div class="col-12">
                <hr>
                <h4>AJAX (sandbox)</h4>
                <p>Below is a Javascript function to perform post the form programatically as well as an example invocation</p>

                <pre>
// Form submit emulator

function formPost(path, params, method = "post") {
    if (typeof document == "undefined") throw new Error("This function is only available in browsers");
            
    var form = document.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", path);
            
    for (var key in params) {
        if (params.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);
            
            form.appendChild(hiddenField);
        }
    }
            
    document.body.appendChild(form);
    form.submit();
}

// Event handler

function buttonClicked() {
    // sandbox
    var URL = "https://sis-t.redsys.es:25443/sis/realizarPago";

    // production
    // var URL = "https://sis.redsys.es/sis/realizarPago";

    var payload = {
        Ds_SignatureVersion: "HMAC_SHA256_V1",
        Ds_MerchantParameters: "eyJEU19NRVJDSEFOVF9BTU9VTlQiOiIxNDUiLCJEU19NRVJDSEFOVF9PUkRFUiI6IjE1MDg0MjgzNjAiLCJEU19NRVJDSEFOVF9NRVJDSEFOVENPREUiOiIzMjcyMzQ2ODgiLCJEU19NRVJDSEFOVF9DVVJSRU5DWSI6Ijk3OCIsIkRTX01FUkNIQU5UX1RSQU5TQUNUSU9OVFlQRSI6IjAiLCJEU19NRVJDSEFOVF9URVJNSU5BTCI6IjEiLCJEU19NRVJDSEFOVF9NRVJDSEFOVFVSTCI6IiIsIkRTX01FUkNIQU5UX1VSTE9LIjoiIiwiRFNfTUVSQ0hBTlRfVVJMS08iOiIifQ==",
        Ds_Signature: "2wzHhG3STJg6m3DTlvf74JHBXp5MI7Ey+scuClRcEzg="
    };

    formPost(URL, payload);

    // this will leave the page
}

                </pre>

                <input type="submit" id="ajax" onclick="ajaxSubmit()" value="Submit transaction" class="btn btn-info" />
                <p>&nbsp;</p>
            </div>
        </div>
    </div>

    <script>
        function formPost(path, params, method = "post") {
            if (typeof document == "undefined") throw new Error("This function is only available in browsers");

            var form = document.createElement("form");
            form.setAttribute("method", method);
            form.setAttribute("action", path);

            for (var key in params) {
                if (params.hasOwnProperty(key)) {
                    var hiddenField = document.createElement("input");
                    hiddenField.setAttribute("type", "hidden");
                    hiddenField.setAttribute("name", key);
                    hiddenField.setAttribute("value", params[key]);

                    form.appendChild(hiddenField);
                }
            }

            document.body.appendChild(form);
            form.submit();
        }

        function ajaxSubmit() {
            // sandbox
            var URL = "https://sis-t.redsys.es:25443/sis/realizarPago";

            // production
            // var URL = "https://sis.redsys.es/sis/realizarPago";

            var payload = {
                Ds_SignatureVersion: "HMAC_SHA256_V1",
                Ds_MerchantParameters: "eyJEU19NRVJDSEFOVF9BTU9VTlQiOiIxNDUiLCJEU19NRVJDSEFOVF9PUkRFUiI6IjE1MDg0MjgzNjAiLCJEU19NRVJDSEFOVF9NRVJDSEFOVENPREUiOiIzMjcyMzQ2ODgiLCJEU19NRVJDSEFOVF9DVVJSRU5DWSI6Ijk3OCIsIkRTX01FUkNIQU5UX1RSQU5TQUNUSU9OVFlQRSI6IjAiLCJEU19NRVJDSEFOVF9URVJNSU5BTCI6IjEiLCJEU19NRVJDSEFOVF9NRVJDSEFOVFVSTCI6IiIsIkRTX01FUkNIQU5UX1VSTE9LIjoiIiwiRFNfTUVSQ0hBTlRfVVJMS08iOiIifQ==",
                Ds_Signature: "2wzHhG3STJg6m3DTlvf74JHBXp5MI7Ey+scuClRcEzg="
            };

            formPost(URL, payload);

            // this will leave the page
        }

    </script>
</body>

</html>